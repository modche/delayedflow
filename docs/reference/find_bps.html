<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Estimates n breakpoints in the DFI curve.
DFI values are compared against n+1 piecewise linear segments and the minimization of the
residuals (between linear segments and DFI curve). Several parameters can be customized.
If q_obs is given in daily temporal resolution then also n can be interpreted as delay in days
for different contributions (default)."><title>Find breakpoints in DFI curve — find_bps • delayedflow</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Find breakpoints in DFI curve — find_bps"><meta property="og:description" content="Estimates n breakpoints in the DFI curve.
DFI values are compared against n+1 piecewise linear segments and the minimization of the
residuals (between linear segments and DFI curve). Several parameters can be customized.
If q_obs is given in daily temporal resolution then also n can be interpreted as delay in days
for different contributions (default)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">delayedflow</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.20</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/tidy_streamflow_contr.html">02 - Delayedflow Analysis in R tidyverse</a>
    <a class="dropdown-item" href="../articles/workflow.html">01 - Workflow with delayflow package</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/modche/delayedflow/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Find breakpoints in DFI curve</h1>
      <small class="dont-index">Source: <a href="https://github.com/modche/delayedflow/blob/HEAD/R/find_bps.R" class="external-link"><code>R/find_bps.R</code></a></small>
      <div class="d-none name"><code>find_bps.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimates n breakpoints in the DFI curve.
DFI values are compared against n+1 piecewise linear segments and the minimization of the
residuals (between linear segments and DFI curve). Several parameters can be customized.
If <code>q_obs</code> is given in daily temporal resolution then also <code>n</code> can be interpreted as delay in days
for different contributions (default).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">find_bps</span><span class="op">(</span>
  <span class="va">dfi</span>,
  n_bp <span class="op">=</span> <span class="fl">2</span>,
  bp_mingap <span class="op">=</span> <span class="fl">5</span>,
  bp_min <span class="op">=</span> <span class="fl">0</span>,
  bp_max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">dfi</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,
  nmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">dfi</span><span class="op">)</span>,
  of_weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>,
  desc <span class="op">=</span> <span class="cn">TRUE</span>,
  print <span class="op">=</span> <span class="cn">FALSE</span>,
  plotting <span class="op">=</span> <span class="cn">FALSE</span>,
  experimental <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>dfi</dt>
<dd><p>numeric, a vector with the DFI values between 1 and 0, dummy data <a href="dfi_example.html">dfi_example</a> can be used.</p></dd>
<dt>n_bp</dt>
<dd><p>numeric, How many breakpoints (1, 2, 3) should be estimated (default = 2)? If <code>n_bp = 3</code>
calculation time could be longer if also <code>nmax</code> is high. <code>nmax</code> could be estimated with <a href="find_nmax.html">find_nmax</a>.
For testing also <code>n_bp = 4</code> is possible See <code>experimental</code> setting.</p></dd>
<dt>bp_mingap</dt>
<dd><p>numeric, smallest interval between two breakpoints (default = 5).</p></dd>
<dt>bp_min</dt>
<dd><p>numeric, <code>bp_min</code>+1 is minimum allowed breakpoint position (default = 0).</p></dd>
<dt>bp_max</dt>
<dd><p>numeric, <code>bp_max</code>-1 is maximum allowed breakpoint position.</p></dd>
<dt>nmax</dt>
<dd><p>numeric parameter to truncate the tailing of the CDC (i.e. the length of <code>dfi</code> vector).
Note, <code>nmax</code> should not be confused with <code>bp_max</code> (i.e. maximum breakpoint position).</p></dd>
<dt>of_weights</dt>
<dd><p>vector with two elements, first is weight of the RMSE, second is weight of the MAE.
Default is c(0.5, 0.5), i.e. equal weights. Sum of vector must be 1. To switch of one measure use
<code>c(1, 0)</code> or <code>c(0,1)</code>. With the weighting more or less focus could be given to the upper parts
of the DFI curve (i.e. when block length <code>n</code> for separation is between 1 and 10).</p></dd>
<dt>desc</dt>
<dd><p>logical, if <code>TRUE</code> (recommended) DFI values are converted to be monotonically decreasing with <code><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cummin()</a></code></p></dd>
<dt>print</dt>
<dd><p>logical, if <code>TRUE</code> best breakpoint estimates during calculation are printed (debug mode)</p></dd>
<dt>plotting</dt>
<dd><p>logical, if <code>TRUE</code> the DFI curve, piecewise linear segments and the breakpoints
are plotted with <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> whit DFI curve in blue and linear segments in red.</p></dd>
<dt>experimental</dt>
<dd><p>logical, if <code>TRUE</code> four breakpoints can be estimated.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a list with 3 elements.</p>
<dl><dt>breakpoints</dt>
<dd><p>estimates for the n breakpoints with names <code>bp_n</code></p></dd>
<dt>bias</dt>
<dd><p>value of the objective function, default:
<code>OF = 1/2 RMSE + 1/2 MAE</code>,
where OF is to be minimized.</p></dd>
<dt>rel_contr</dt>
<dd><p>Relative streamflow contributions between <code>bp_min</code>, the breakpoints and <code>bp_max</code>,
e.g. 2 breakpoints lead to 3 relative contributions, 3 breakpoints lead to 4 relative contributions.
The first <code>rel_contr</code>-value is the fastest contribution to streamflow, the last <code>rel_contr</code>-value
is the slowest contribution to streamflow. All contributions add up to 1.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Stoelzle, M., Schuetz, T., Weiler, M., Stahl, K., &amp; Tallaksen, L. M. (2020). Beyond binary baseflow separation: a delayed-flow index for multiple streamflow contributions. Hydrology and Earth System Sciences, 24(2), 849-867.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># use dfi_example as an DFI vector with 121 values</span></span>
<span class="r-in"><span class="fu">find_bps</span><span class="op">(</span><span class="va">dfi_example</span>, n_bp <span class="op">=</span> <span class="fl">3</span>, bp_max <span class="op">=</span> <span class="fl">90</span>, plotting <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating breakpoints...Done. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-plt img"><img src="find_bps-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bps_position</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bp_1 bp_2 bp_3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4   18   60 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $bias</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.01066672</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rel_contr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   contr_1   contr_2   contr_3   contr_4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3638711 0.2101886 0.2368266 0.1891137 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Stoelzle.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer></div>

  

  

  </body></html>

