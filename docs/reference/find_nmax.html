<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Find maximum breakpoint position based on low flow threshold(s) — find_nmax • delayedflow</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Find maximum breakpoint position based on low flow threshold(s) — find_nmax" />
<meta property="og:description" content="In order to constrain breakpoint analysis on DFI curves (CDCs = Characteristic
Delay Curves) the length of 1:N delayed flow separations should be as short as possible. Normally the
position N is searched where the CDCs is flattening out (slope = 0). To do this the DFI values of 1:N
separations are compared against typical low flow indices (like the MAM/MQ). The low flow indices
ranging between 0 and 1 indicating the low flow sensitivity. High index values (e.g. 0.60) indicating more
stable flow regimes with larger catchment storages, lower index values (e.g. 0.20) indicating rather flashy
flow regimes with faster recession behavior. The maximum breakpoint position is estimated by estimating the
DFI value with a separation block size of N that match the index value." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">delayedflow</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.20</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/tidy_streamflow_contr.html">02 - Delayedflow Analysis in R tidyverse</a>
    </li>
    <li>
      <a href="../articles/workflow.html">01 - Workflow with delayflow package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/modche/delayedflow/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Find maximum breakpoint position based on low flow threshold(s)</h1>
    <small class="dont-index">Source: <a href='https://github.com/modche/delayedflow/blob/master/R/find_nmax.R'><code>R/find_nmax.R</code></a></small>
    <div class="hidden name"><code>find_nmax.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>In order to constrain breakpoint analysis on DFI curves (CDCs = Characteristic
Delay Curves) the length of 1:N delayed flow separations should be as short as possible. Normally the
position N is searched where the CDCs is flattening out (slope = 0). To do this the DFI values of 1:N
separations are compared against typical low flow indices (like the MAM/MQ). The low flow indices
ranging between 0 and 1 indicating the low flow sensitivity. High index values (e.g. 0.60) indicating more
stable flow regimes with larger catchment storages, lower index values (e.g. 0.20) indicating rather flashy
flow regimes with faster recession behavior. The maximum breakpoint position is estimated by estimating the
DFI value with a separation block size of N that match the index value.</p>
    </div>

    <pre class="usage"><span class='fu'>find_nmax</span><span class='op'>(</span><span class='va'>df</span>, n <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>180</span>, desc <span class='op'>=</span> <span class='cn'>TRUE</span>, lowflow_index <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"mam_mq"</span><span class='op'>)</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>df</th>
      <td><p>data.frame with two columns, first column must be Date, second must be streamflow
data.</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>numeric vector</p></td>
    </tr>
    <tr>
      <th>desc</th>
      <td><p>logical, if <code>TRUE</code> DFI values are converted to be monotonically decreasing with <code><a href='https://rdrr.io/r/base/cumsum.html'>cummin()</a></code></p></td>
    </tr>
    <tr>
      <th>lowflow_index</th>
      <td><p>Which Low Flow Index should be used? MAM/MQ (default), Q95/Q50, Q90/Q50.
Index names are "mam_mq", "q95_q50" or "q90_q50". Note that especially in highly seasonal regimes
the deviation between the indices might be large(r).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Function returns a list with two elements: <code>$index_value</code> and <code>$bp_nmax</code></p>
<dt>index_value</dt><dd><p>Index value of the used low flow index ranging between 0 and 1.
Higher values indicating more stable flow regimes and less low flow sensitivity.</p></dd>
<dt>bp_nmax</dt><dd><p>Position <code>N</code> of breakpoint where absolute deviation between <code>DFI_N</code>
and low flow index is minimal (considering all <code>DFI</code> values), <code><a href='https://rdrr.io/r/base/Extremes.html'>min(which.min(abs(cdc$dfi-index)))</a></code></p></dd>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>find_nmax</span><span class='op'>(</span><span class='va'>q_data</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $index_value
#&gt; [1] 0.1126447
#&gt; 
#&gt; $bp_nmax
#&gt; [1] 65
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Michael Stoelzle.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


